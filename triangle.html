<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Triangle Fraternity Smart Trainer</title>
    <style>
        :root {
            --triangle-rose: #800000; /* Approximate Old Rose */
            --triangle-gray: #666666;
            --bg: #f8f9fa;
            --card-bg: #ffffff;
            --text: #212529;
            --success: #28a745;
            --fail: #dc3545;
            --mastered: #ffd700;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background-color: var(--bg);
            color: var(--text);
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
        }

        .container {
            width: 100%;
            max-width: 600px;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        /* HEADER & PROGRESS */
        header {
            text-align: center;
            margin-bottom: 10px;
        }
        h1 { color: var(--triangle-rose); margin: 0; font-size: 1.8rem; text-transform: uppercase; letter-spacing: 1px; }
        .stats-bar {
            display: flex;
            justify-content: space-between;
            font-size: 0.9rem;
            color: var(--triangle-gray);
            margin-top: 5px;
            font-weight: bold;
        }
        
        .progress-container {
            width: 100%;
            height: 10px;
            background-color: #e9ecef;
            border-radius: 5px;
            overflow: hidden;
            margin-bottom: 20px;
        }
        .progress-fill {
            height: 100%;
            background-color: var(--success);
            width: 0%;
            transition: width 0.3s ease;
        }

        /* FLASHCARD */
        .card {
            background: var(--card-bg);
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            text-align: center;
            position: relative;
            border-top: 5px solid var(--triangle-rose);
            min-height: 200px;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .category-badge {
            position: absolute;
            top: 10px;
            right: 10px;
            background: #eee;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.7rem;
            text-transform: uppercase;
            font-weight: bold;
            color: #555;
        }

        .streak-badge {
            position: absolute;
            top: 10px;
            left: 10px;
            font-size: 0.8rem;
            font-weight: bold;
            color: var(--triangle-gray);
        }

        .question {
            font-size: 1.3rem;
            font-weight: 600;
            margin-bottom: 20px;
            line-height: 1.4;
        }

        /* OPTIONS */
        .options-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 10px;
        }
        @media (min-width: 480px) {
            .options-grid { grid-template-columns: 1fr 1fr; }
        }

        button.option-btn {
            background: white;
            border: 2px solid #dee2e6;
            border-radius: 8px;
            padding: 15px;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.2s;
            color: var(--text);
            font-weight: 500;
        }

        button.option-btn:hover {
            border-color: var(--triangle-rose);
            background-color: #fff0f0;
        }

        button.option-btn.correct {
            background-color: var(--success);
            border-color: var(--success);
            color: white;
        }

        button.option-btn.wrong {
            background-color: var(--fail);
            border-color: var(--fail);
            color: white;
            opacity: 0.6;
        }

        /* CONTROLS */
        .controls {
            margin-top: 20px;
            text-align: center;
        }
        .next-btn {
            background-color: var(--triangle-rose);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 25px;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            display: none; /* Hidden initially */
            box-shadow: 0 4px 10px rgba(128, 0, 0, 0.3);
        }
        .next-btn:hover { background-color: #600000; transform: translateY(-2px); }

        .reset-link {
            margin-top: 30px;
            font-size: 0.8rem;
            color: #999;
            text-decoration: underline;
            cursor: pointer;
        }

        /* FEEDBACK OVERLAY */
        #feedback {
            margin-top: 15px;
            font-weight: bold;
            height: 20px;
        }
    </style>
</head>
<body>

<div class="container">
    <header>
        <h1>Triangle Trainer</h1>
        <div class="stats-bar">
            <span>Mastery Progress</span>
            <span id="progressText">0%</span>
        </div>
        <div class="progress-container">
            <div class="progress-fill" id="progressBar"></div>
        </div>
    </header>

    <div class="card">
        <div class="streak-badge">Streak: <span id="currentStreak">0</span>/10</div>
        <div class="category-badge" id="categoryBadge">Loading...</div>
        <div class="question" id="questionDisplay">Welcome to the Trainer.</div>
        <div id="feedback"></div>
    </div>

    <div class="options-grid" id="optionsGrid">
        </div>

    <div class="controls">
        <button class="next-btn" id="nextBtn">Next Question</button>
        <div class="reset-link" onclick="resetProgress()">Reset All Progress</div>
    </div>
</div>

<script>
    // ================= DATA =================
    // The "Brain" needs data. Here is everything you provided.
    
    const facts = [
        { q: "What are the House Colors?", a: "Old rose and gray", cat: "Facts" },
        { q: "What is the House Flower?", a: "The white Chrysanthemum", cat: "Facts" },
        { q: "What is the Triangle Motto?", a: "Veritas Omnia Vincit", cat: "Facts" },
        { q: "Translate 'Veritas Omnia Vincit'", a: "Truth Conquers All", cat: "Facts" },
        { q: "When and where was Triangle founded?", a: "April 15, 1907 at Univ of Illinois", cat: "Facts" },
        { q: "Who founded Triangle?", a: "16 Civil Engineering Students", cat: "Facts" },
        { q: "When was the PSU Chapter founded?", a: "March 3rd, 1928", cat: "Facts" },
        { q: "Who is the House Mom?", a: "Taylor", cat: "Facts" },
        { q: "Who are the Sweethearts?", a: "Priya, Navya, Isabelle", cat: "Facts" },
        { q: "In 'Everyman', what does God represent?", a: "The Unknown", cat: "Facts" },
        { q: "What is the moral of 'Everyman'?", a: "Only good deeds stay with you when you die", cat: "Facts" },
        { q: "What is Tee Grizzley's real name?", a: "Terry Sanchez Wallace Jr.", cat: "Facts" },
        { q: "Where did Tee Grizzley go to school?", a: "Michigan State", cat: "Facts" }
    ];

    const ethics = [
        { q: "Complete: 'Observe the precepts of the Fraternity as set forth in the...'", a: "Ritual", cat: "Ethics" },
        { q: "Complete: 'Accept cheerfully my full share of any task, however...'", a: "Menial", cat: "Ethics" },
        { q: "Complete: 'Pay all personal bills promptly, and always live within my...'", a: "Means", cat: "Ethics" },
        { q: "Complete: 'Maintain a creditable...'", a: "Scholastic record", cat: "Ethics" },
        { q: "Complete: 'Promote the welfare of my...'", a: "Profession", cat: "Ethics" },
        { q: "Complete: 'Maintain my self-respect by proper...'", a: "Conduct at all times", cat: "Ethics" },
        { q: "Complete: 'Pay the price of success in...'", a: "Honest effort", cat: "Ethics" }
    ];

    const greek = [
        { q: "Greek letter: Alpha", a: "Î‘", cat: "Greek" }, { q: "Greek letter: Beta", a: "Î’", cat: "Greek" },
        { q: "Greek letter: Gamma", a: "Î“", cat: "Greek" }, { q: "Greek letter: Delta", a: "Î”", cat: "Greek" },
        { q: "Greek letter: Epsilon", a: "Î•", cat: "Greek" }, { q: "Greek letter: Zeta", a: "Î–", cat: "Greek" },
        { q: "Greek letter: Eta", a: "Î—", cat: "Greek" }, { q: "Greek letter: Theta", a: "Î˜", cat: "Greek" },
        { q: "Greek letter: Iota", a: "Î™", cat: "Greek" }, { q: "Greek letter: Kappa", a: "Îš", cat: "Greek" },
        { q: "Greek letter: Lambda", a: "Î›", cat: "Greek" }, { q: "Greek letter: Mu", a: "Îœ", cat: "Greek" },
        { q: "Greek letter: Nu", a: "Î", cat: "Greek" }, { q: "Greek letter: Xi", a: "Îž", cat: "Greek" },
        { q: "Greek letter: Omicron", a: "ÎŸ", cat: "Greek" }, { q: "Greek letter: Pi", a: "Î ", cat: "Greek" },
        { q: "Greek letter: Rho", a: "Î¡", cat: "Greek" }, { q: "Greek letter: Sigma", a: "Î£", cat: "Greek" },
        { q: "Greek letter: Tau", a: "Î¤", cat: "Greek" }, { q: "Greek letter: Upsilon", a: "Î¥", cat: "Greek" },
        { q: "Greek letter: Phi", a: "Î¦", cat: "Greek" }, { q: "Greek letter: Chi", a: "Î§", cat: "Greek" },
        { q: "Greek letter: Psi", a: "Î¨", cat: "Greek" }, { q: "Greek letter: Omega", a: "Î©", cat: "Greek" }
    ];

    const people = [
        // Pledges
        { name: "Gavin Hoover", major: "Industrial Eng", town: "Philly", role: "Pledge", fact: "", type: "Pledge" },
        { name: "Justin Hnat", major: "Mechanical Eng", town: "Philly", role: "Pledge", fact: "", type: "Pledge" },
        { name: "Aditya Phophaliya", major: "CS and AI", town: "NYC", role: "Pledge", fact: "", type: "Pledge" },
        { name: "Thomas Youssef", major: "Electrical Eng", town: "Dubai, UAE", role: "Pledge", fact: "", type: "Pledge" },
        { name: "Augie Esposito", major: "Architectural Eng", town: "Philly", role: "Pledge", fact: "", type: "Pledge" },
        { name: "Kory Lafferty", major: "Aerospace Eng", town: "Cape May, NJ", role: "Pledge", fact: "", type: "Pledge" },
        { name: "Finn Bracken", major: "Computer Eng", town: "Medford, NJ", role: "Pledge", fact: "", type: "Pledge" },
        { name: "Kerlos Rafayel", major: "Electrical Eng", town: "Whitehall, PA", role: "Pledge", fact: "", type: "Pledge" },
        { name: "Lucas Walthour", major: "Aerospace Eng", town: "Marriottsville, MD", role: "Pledge", fact: "", type: "Pledge" },
        { name: "Joshua Staley", major: "Chem E / Astro", town: "Yorktown, VA", role: "Pledge", fact: "", type: "Pledge" },
        { name: "Thomas Askharoun", major: "Electrical Eng", town: "Cairo, Egypt", role: "Pledge", fact: "", type: "Pledge" },

        // Brothers
        { name: "Justin Quinn", major: "Mechanical Eng", town: "Broomall, PA", role: "President", type: "Brother" },
        { name: "Mason Truban", major: "Aerospace Eng", town: "Middletown, DE", role: "VPM", type: "Brother" },
        { name: "Bobby Kosslow", major: "Aerospace Eng", town: "Pittsburgh, PA", role: "VPHM", type: "Brother" },
        { name: "Max Lick", major: "Data Science", town: "Scranton, PA", role: "VP Thon", type: "Brother" },
        { name: "Hunter Orlofski", major: "Aerospace Eng", town: "Lehman, PA", role: "VPS", type: "Brother" },
        { name: "Will Meyer", major: "Computer Eng", town: "Albany, NY", role: "VPA", type: "Brother" },
        { name: "Grant Benson", major: "Aerospace Eng", town: "Springfield, VA", role: "VPX", type: "Brother" },
        { name: "James Tritto", major: "Forestry/Poli Sci", town: "Seaside Heights, NJ", role: "", type: "Brother" },
        { name: "Spencer Rothka", major: "Aerospace Eng", town: "Hernden, VA", role: "", type: "Brother" },
        { name: "Jack Mussoline", major: "Computer Eng", town: "Irving, CA", role: "", type: "Brother" },
        { name: "Thomas Israel", major: "Aerospace Eng", town: "Asheville, NC", role: "", type: "Brother" },
        { name: "Jack Boyle", major: "Civil Eng", town: "Morgantown, WV", role: "", type: "Brother" },
        { name: "Niko Rylott", major: "Kinesiology", town: "Newcastle, PA", role: "", type: "Brother" },
        { name: "Jay Palla", major: "Computer Eng", town: "Garnet Valley, PA", role: "", type: "Brother" },
        { name: "Andrew Griesacker", major: "Aerospace Eng", town: "Moon Township, PA", role: "", type: "Brother" },
        { name: "Thomas Rohan", major: "Nuclear Eng", town: "Scranton, PA", role: "", type: "Brother" },
        { name: "Matthew Avery", major: "Electrical Eng", town: "Emerson, NJ", role: "", type: "Brother" },
        { name: "Kourosh Sadr", major: "Nuclear Eng", town: "San Diego, CA", role: "", type: "Brother" },
        { name: "Ryan Maietta", major: "Electrical Eng", town: "Lititz, PA", role: "", type: "Brother" },
        { name: "Josh McQuilken", major: "Science BSHP", town: "New Tripoli, PA", role: "", type: "Brother" },
        { name: "Ishaan Nrangg", major: "Computer Science", town: "Chandigarh, India", role: "", type: "Brother" },
        { name: "Michael Nornthrop", major: "Industrial Eng", town: "Interboro, PA", role: "", type: "Brother" },
        { name: "Misha Goldberg", major: "Nuclear Eng", town: "San Francisco, CA", role: "", type: "Brother" },
        { name: "Derek Shephard", major: "Ag Systems Mgmt", town: "Camden, NJ", role: "", fact: "Runs with gangs", type: "Brother" },
        { name: "Noah Greep", major: "Mechanical Eng", town: "Uniontown, PA", role: "", type: "Brother" },
        { name: "Josh Hassenau", major: "Enviro Systems Eng", town: "Greenville, SC", role: "", type: "Brother" },
        { name: "Lucas Shawley", major: "Civil Eng", town: "Spring Hills, PA", role: "", type: "Brother" },
        { name: "Sam Mattis", major: "HPA", town: "West Chester, PA", role: "", type: "Brother" },
        { name: "Colton Middaugh", major: "CS", town: "Dillsburg, PA", role: "", type: "Brother" },
        { name: "Logan Taylor", major: "CS", town: "Dillsburg, PA", role: "", type: "Brother" },
        { name: "Joshua Levin", major: "Aerospace Eng", town: "White Plains, NY", role: "", type: "Brother" },
        { name: "Tyler Gilbert", major: "Aerospace Eng", town: "Mountoursville, PA", role: "", type: "Brother" },
        { name: "Eugene Kaz", major: "Aerospace Eng", town: "Grodno, Belarus", role: "", type: "Brother" },
        { name: "Athan Ozmen", major: "Mechanical Eng", town: "Turkey", role: "", type: "Brother" },
        { name: "Siddarth Jayakrishnan", major: "Mat Sci", town: "Pittsburgh, PA", role: "", type: "Brother" },
        { name: "Deniz Kiraz", major: "Unknown", town: "Istanbul, Turkey", role: "", type: "Brother" },
        { name: "Nick Smith", major: "Biomedical Eng", town: "Perkasie, PA", role: "", type: "Brother" }
    ];

    // ================= LOGIC =================
    
    // We transform everything into a "Card" object
    let db = [];
    const MASTERY_THRESHOLD = 10;

    function initDB() {
        // 1. Facts
        facts.forEach((f, i) => db.push({ id: `f_${i}`, q: f.q, a: f.a, cat: f.cat }));
        
        // 2. Ethics
        ethics.forEach((e, i) => db.push({ id: `e_${i}`, q: e.q, a: e.a, cat: e.cat }));
        
        // 3. Greek
        greek.forEach((g, i) => db.push({ id: `g_${i}`, q: g.q, a: g.a, cat: g.cat }));

        // 4. People (Generate 2-3 cards per person)
        people.forEach((p, i) => {
            // Major
            db.push({ id: `p_${i}_maj`, q: `What is ${p.name}'s Major?`, a: p.major, cat: p.type, link: p });
            // Hometown
            db.push({ id: `p_${i}_town`, q: `Where is ${p.name} from?`, a: p.town, cat: p.type, link: p });
            // Role (if exists)
            if(p.role && p.role !== "Pledge" && p.role !== "") {
                db.push({ id: `p_${i}_role`, q: `Who is the ${p.role}?`, a: p.name, cat: "Leadership", link: p });
            }
            // Fact (if exists)
            if(p.fact) {
                db.push({ id: `p_${i}_fact`, q: `Fact: "${p.fact}"`, a: p.name, cat: "Fact", link: p });
            }
        });

        // Load stats from LocalStorage
        const saved = JSON.parse(localStorage.getItem('triangle_stats')) || {};
        db.forEach(card => {
            if(saved[card.id]) {
                card.streak = saved[card.id];
            } else {
                card.streak = 0;
            }
        });
    }

    let currentCard = null;

    function saveStats() {
        const stats = {};
        db.forEach(c => stats[c.id] = c.streak);
        localStorage.setItem('triangle_stats', JSON.stringify(stats));
        updateProgress();
    }

    function updateProgress() {
        const total = db.length;
        const mastered = db.filter(c => c.streak >= MASTERY_THRESHOLD).length;
        const pct = Math.floor((mastered / total) * 100);
        document.getElementById('progressBar').style.width = `${pct}%`;
        document.getElementById('progressText').innerText = `${pct}%`;
    }

    function getDistractors(card) {
        let options = [card.a];
        let pool = [];

        // Smart Distractors based on category
        if (card.cat === "Facts") pool = facts.map(f => f.a);
        else if (card.cat === "Ethics") pool = ethics.map(e => e.a);
        else if (card.cat === "Greek") pool = greek.map(g => g.a);
        else if (card.cat === "Leadership") pool = people.map(p => p.name);
        else if (card.q.includes("Major")) pool = people.map(p => p.major);
        else if (card.q.includes("Where")) pool = people.map(p => p.town);
        else pool = people.map(p => p.name); // Default to names

        // Filter duplicates and current answer
        pool = [...new Set(pool)].filter(opt => opt !== card.a);

        // Shuffle pool
        pool.sort(() => 0.5 - Math.random());

        // Take 3
        options.push(...pool.slice(0, 3));
        
        // Final Shuffle
        return options.sort(() => 0.5 - Math.random());
    }

    function nextQuestion() {
        document.getElementById('nextBtn').style.display = 'none';
        document.getElementById('feedback').innerText = '';
        document.getElementById('optionsGrid').innerHTML = '';

        // Filter for non-mastered items
        let candidates = db.filter(c => c.streak < MASTERY_THRESHOLD);
        
        // If all mastered, show celebration or review
        if(candidates.length === 0) {
            candidates = db; // Review mode
            document.getElementById('questionDisplay').innerText = "ðŸŽ‰ All Mastered! Review Mode.";
        }

        // Pick random
        currentCard = candidates[Math.floor(Math.random() * candidates.length)];

        // UI Update
        document.getElementById('categoryBadge').innerText = currentCard.cat;
        document.getElementById('currentStreak').innerText = currentCard.streak;
        document.getElementById('questionDisplay').innerText = currentCard.q;

        // Options
        const opts = getDistractors(currentCard);
        const grid = document.getElementById('optionsGrid');
        
        opts.forEach(opt => {
            const btn = document.createElement('button');
            btn.className = 'option-btn';
            btn.innerText = opt;
            btn.onclick = () => handleAnswer(btn, opt);
            grid.appendChild(btn);
        });
    }

    function handleAnswer(btn, selected) {
        const isCorrect = selected === currentCard.a;
        const btns = document.querySelectorAll('.option-btn');
        
        // Disable all
        btns.forEach(b => b.onclick = null);

        if(isCorrect) {
            btn.classList.add('correct');
            currentCard.streak++;
            document.getElementById('feedback').innerText = "Correct! Streak +1";
            document.getElementById('feedback').style.color = "var(--success)";
        } else {
            btn.classList.add('wrong');
            currentCard.streak = 0; // RESET STREAK
            document.getElementById('feedback').innerText = "Wrong! Streak reset to 0.";
            document.getElementById('feedback').style.color = "var(--fail)";
            
            // Highlight correct
            btns.forEach(b => {
                if(b.innerText === currentCard.a) b.classList.add('correct');
            });
        }

        saveStats();
        document.getElementById('nextBtn').style.display = 'inline-block';
        document.getElementById('nextBtn').onclick = nextQuestion;
    }

    function resetProgress() {
        if(confirm("Reset all mastery progress?")) {
            localStorage.removeItem('triangle_stats');
            location.reload();
        }
    }

    // Init
    initDB();
    updateProgress();
    nextQuestion();

</script>

</body>
</html>
